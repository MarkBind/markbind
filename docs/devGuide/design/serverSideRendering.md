{% set title = "Server Side Rendering" %}
<span id="title" class="d-none">{{ title }}</span>

<frontmatter>
  title: "{{ title }}"
  layout: devGuide.md
  pageNav: default
</frontmatter>

# {{ title }}

<div class="lead">

MarkBind makes use of server-side rendering (SSR) for its pages. To ensure SSR works properly, there are certain rules that developers should adhere to. 

This page will describe SSR in general and elaborate on the things that developers should take note of when developing. 
</div>

## What is Server-side Rendering and Why?

In MarkBind's context, Server-side Rendering refers to the generation of proper HTML strings from Vue components on the server (core library) instead of shifting that responsibility to the client-side (browser). 

The main motivation that we had for introducing SSR into MarkBind is to enhance user experience by resolving the unsightly issue of Flash-of-Unstyled-Content (FOUC), which occurs due to our reliance on Client-side Rendering. 

## Client-side Hydration

Server-side Rendering and Client-side Hydration are 2 concepts that go hand-in-hand. Essentially, once we produce the static HTML via SSR and send it over to the client-side, Vue on the client-side will execute what is known as Client-side Hydration on the static HTML.

During the hydration process, Vue essentially `diff`s your SSR HTML markup against the virtual DOM generated by the render function on the client-side. If any difference is found, meaning that the application that we have on the client-side (the virtual DOM tree) differs from the SSR HTML mark-up that we send to the client, Vue will reject the SSR HTML output, bail Client-side Hydration, and execute full Client-side Rendering.

This is known as "Hydration Issue" and it is one of the main challenges you will face with SSR in MarkBind. 

## Avoiding Hydration Issue 

Conceptually, to prevent hydration issue, what we should always strive to achieve is a "universal application". 
It is not difficult to achieve a "universal application" per-se because we merely have to ensure two things:
1) the state data are the same between client-side and server-side.
2) after compiling and rendering the Vue page application, the SSR HTML mark-up is not modified.

However, beyond achieving a "universal application", there are also some more specific rules that we should adhere to, so that we do not run into hydration issue: 
- Do not violate HTML spec as much as possible (e.g. having block-level elements within `<p>` tag).
- Having unknown HTML elements within our Vue application during compilation/rendering (though this can be easily resolved by adding `v-pre` to the unknown element, so that Vue will ignore that element during compilation). 

Note that the list only included the common causes of hydration issue that MarkBind developers have ran into. There may be other causes of hydration issue that are not listed here (although unlikely).

## Learning more about SSR in MarkBind and Debugging Hydration Issue


