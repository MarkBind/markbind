<!DOCTYPE html>
<html>

<head>

  <meta name="default-head-top">
  <script src="/test_site/headFiles/customScriptTop.js"></script>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="MarkBind 6.0.1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Rendering of diagrams via mermaid-js</title>
  <link rel="stylesheet" href="/test_site/markbind/css/bootstrap.min.css">
  <link rel="stylesheet" href="/test_site/markbind/fontawesome/css/all.min.css">
  <link rel="stylesheet" href="/test_site/markbind/glyphicons/css/bootstrap-glyphicons.min.css">
  <link rel="stylesheet" href="/test_site/markbind/css/codeblock-dark.min.css">
  <link rel="stylesheet" href="/test_site/markbind/css/markbind.min.css">
  <link rel="stylesheet" href="/test_site/plugins/testMarkbindPlugin/testMarkbindPluginStylesheet.css">
  <link rel="stylesheet" href="/test_site/plugins/web3Form/web-3-form.css">
  <link rel="stylesheet" href="/test_site/plugins/markbind-plugin-anchors/markbind-plugin-anchors.css">
  <link rel="stylesheet" href="/test_site/plugins/markbind-plugin-tree/markbind-plugin-tree.css">

  <meta name="default-head-bottom">
  <link rel="stylesheet" href="/test_site/stylesheets/styles.css">
  <script src="/test_site/headFiles/customScriptBottom.js"></script>
  <link rel="icon" href="/test_site/favicon.png">
</head>
<script>
  const baseUrl = '/test_site'
</script>

<body>
  <div id="app">

    <div>
      <header>
        <navbar type="dark" default-highlight-on="sibling-or-child">
          <template #brand><a href="/" title="Home" class="navbar-brand">MarkBind Test Site</a></template>
          <li><a class="nav-link" href="/test_site/bugs/index.html">Open Bugs</a></li>
        </navbar>
        <div class="bg-info display-4 text-center text-white">
          <br>
          Test Jumbotron<br>
          <br>
        </div>
      </header>
      <p><strong>Relative Link Test</strong> This is a relative Intra-Site link in a layout (see <a href="/test_site/index.html#heading-with-hidden-keyword">link</a>)</p>
    </div>
    <div id="flex-body">
      <overlay-source id="site-nav" tag-name="nav" to="site-nav">
        <div class="site-nav-top">
          <div class="fw-bold mb-2" style="font-size: 1.25rem;">
            <div>
              <h2 id="default-layout">Default Layout<a class="fa fa-anchor" href="#default-layout" onclick="event.stopPropagation()"></a></h2>
            </div>
          </div>
        </div>
        <div class="nav-component slim-scroll">
          <div>
            <site-nav>
              <overlay-source class="site-nav-list site-nav-list-root" tag-name="ul" to="mb-site-nav">
                <li>
                  <div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="/test_site/index.html">Home üè†</a></div>
                </li>
                <li>
                  <div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="/test_site/bugs/index.html">Open Bugs üêõ</a></div>
                </li>
                <li class="site-nav-custom-list-item site-nav-list-item-0">
                  <h3 id="testing-site-nav">Testing Site-Nav<a class="fa fa-anchor" href="#testing-site-nav" onclick="event.stopPropagation()"></a></h3>
                </li>
                <li>
                  <div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><strong>Dropdown </strong> <span aria-hidden="true" class="glyphicon glyphicon-search"></span> title ‚úèÔ∏è
                    <!-- Nested list items will be placed inside a Dropdown menu -->

                    <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon site-nav-rotate-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                        <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                      </i></div>
                  </div>
                  <ul class="site-nav-dropdown-container site-nav-dropdown-container-open site-nav-list">
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)"><a href="https://www.google.com/">Dropdown link one</a></div>
                    </li>
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)"><a href="https://www.google.com/">Html within site-nav <span style="color: red;">should</span> be displayed properly</a></div>
                    </li>
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)">Nested Dropdown title üìê

                        <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                            <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                          </i></div>
                      </div>
                      <ul class="site-nav-dropdown-container site-nav-list">
                        <li>
                          <div class="site-nav-default-list-item site-nav-list-item-2" onclick="handleSiteNavClick(this)"><a href="https://www.google.com/"><strong>Nested</strong> Dropdown link one</a></div>
                        </li>
                        <li>
                          <div class="site-nav-default-list-item site-nav-list-item-2" onclick="handleSiteNavClick(this)"><a href="https://www.google.com/"><strong>Nested</strong> Dropdown link two</a></div>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)"><a href="https://www.google.com/">Dropdown link two</a></div>
                    </li>
                  </ul>
                </li>
                <li>
                  <div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="https://www.google.com/"><mark>Third Link</mark> üìã</a></div>
                </li>
                <li>
                  <div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)">Filler text <a href="https://www.youtube.com/"><span aria-hidden="true" class="glyphicon glyphicon-facetime-video"></span> Youtube üì∫</a> filler text
                    <!-- Using a link as a Dropdown title will not render a Dropdown menu -->

                    <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                        <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                      </i></div>
                  </div>
                  <ul class="site-nav-dropdown-container site-nav-list">
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)"><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">The answer to everything in the universe</a></div>
                    </li>
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)"><mark>Dropdown title</mark> <span aria-hidden="true" class="glyphicon glyphicon-comment"></span> ‚úèÔ∏è
                        <!-- Dropdown menus in are still supported inside, as long as the title is not a link -->

                        <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon site-nav-rotate-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                            <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                          </i></div>
                      </div>
                      <ul class="site-nav-dropdown-container site-nav-dropdown-container-open site-nav-list">
                        <li>
                          <div class="site-nav-default-list-item site-nav-list-item-2" onclick="handleSiteNavClick(this)"><a href="https://www.google.com/"><strong>Nested</strong> Dropdown link one</a></div>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li>
                  <div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)">Really Long Dropdown Title Really Long Dropdown Title Really Long Dropdown Title Really Long Dropdown

                    <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                        <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                      </i></div>
                  </div>
                  <ul class="site-nav-dropdown-container site-nav-list">
                    <li class="site-nav-custom-list-item site-nav-list-item-1">Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text Really Really Long Text</li>
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)">Nested Dropdown Title

                        <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                            <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                          </i></div>
                      </div>
                      <ul class="site-nav-dropdown-container site-nav-list">
                        <li class="site-nav-custom-list-item site-nav-list-item-2">Hello Doge Hello Doge üê∂</li>
                        <li>
                          <div class="site-nav-default-list-item site-nav-list-item-2" onclick="handleSiteNavClick(this)"><a href="/test_site/index.html"><strong>NESTED LINK</strong> Home üè†</a></div>
                        </li>
                        <li class="site-nav-custom-list-item site-nav-list-item-2">Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit Text cut off from height limit</li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li>
                  <div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)">Test line break in navigation layout

                    <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                        <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                      </i></div>
                  </div>
                  <ul class="site-nav-dropdown-container site-nav-list">
                    <li class="site-nav-custom-list-item site-nav-list-item-1">Nested line break text ‚úÇÔ∏è</li>
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)"><a href="/test_site/index.html">Nested line break href</a>

                        <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                            <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                          </i></div>
                      </div>
                      <ul class="site-nav-dropdown-container site-nav-list">
                        <li class="site-nav-custom-list-item site-nav-list-item-2">Nested Nested line break text ‚úÇÔ∏è</li>
                      </ul>
                    </li>
                    <li>
                      <div class="site-nav-default-list-item site-nav-list-item-1" onclick="handleSiteNavClick(this)">Nested line break dropdown menu

                        <div class="site-nav-dropdown-btn-container"><i class="site-nav-dropdown-btn-icon" onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();">
                            <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                          </i></div>
                      </div>
                      <ul class="site-nav-dropdown-container site-nav-list">
                        <li class="site-nav-custom-list-item site-nav-list-item-2">Line break item 2 üìò</li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </overlay-source>
            </site-nav>
          </div>
        </div>
      </overlay-source>
      <div id="content-wrapper">
        <breadcrumb></breadcrumb>
        <p><strong>Mermaid Test</strong></p>
        <h4 id="test-some-sample-mermaid-diagrams-load">Test some sample Mermaid diagrams load<a class="fa fa-anchor" href="#test-some-sample-mermaid-diagrams-load" onclick="event.stopPropagation()"></a></h4>
        <pre class="mermaid">
%%{init: { "theme": "neutral" } }%%

graph TD;
A-->B;
A-->C;
B-->D;
C-->D;
</pre>
        <pre class="mermaid">
graph TD;
    A-->B;
    A-->C;
    B-->D;
    C-->D;
</pre>
        <pre class="mermaid">
sequenceDiagram
    participant Alice
    participant Bob
    Alice->>John: Hello John, how are you?
    loop Healthcheck
        John->>John: Fight against hypochondria
    end
    Note right of John: Rational thoughts <br>prevail!
    John-->>Alice: Great!
    John->>Bob: How about you?
    Bob-->>John: Jolly good!
</pre>
        <pre class="mermaid">
gantt
dateFormat  YYYY-MM-DD
title Adding GANTT diagram to mermaid
section A section
Completed task            :done,    des1, 2014-01-06,2014-01-08
Active task               :active,  des2, 2014-01-09, 3d
Future task               :         des3, after des2, 5d
Future task2               :         des4, after des3, 5d

section Critical tasks
Completed task in the critical line :crit, done, 2014-01-06,24h
Implement parser and jison          :crit, done, after des1, 2d
Create tests for parser             :crit, active, 3d
Future task in critical line        :crit, 5d
Create tests for renderer           :2d
Add to mermaid                      :1d

section Documentation
Describe gantt syntax               :active, a1, after des1, 3d
Add gantt diagram to demo page      :after a1  , 20h
Add another diagram to demo page    :doc1, after a1  , 48h

section Last section
Describe gantt syntax               :after doc1, 3d
Add gantt diagram to demo page      : 20h
Add another diagram to demo page    : 48h
</pre>
        <h4 id="test-standard-formatting-of-mermaid-diagrams-load-using-pre">Test standard formatting of Mermaid diagrams load (using pre)<a class="fa fa-anchor" href="#test-standard-formatting-of-mermaid-diagrams-load-using-pre" onclick="event.stopPropagation()"></a></h4>
        <pre class="mermaid">
  graph LR
      A --- B
      B-->C[fa:fa-ban forbidden]
      B-->D(fa:fa-spinner);
</pre>
        <h4 id="test-dynamically-loaded-mermaid-diagrams">Test dynamically loaded Mermaid diagrams<a class="fa fa-anchor" href="#test-dynamically-loaded-mermaid-diagrams" onclick="event.stopPropagation()"></a></h4>
        <panel type="minimal"><template #header>
            <p>This is to test Mermaid diagrams work in panel.</p>
          </template>
          <pre class="mermaid">
pie title Pets adopted by volunteers
    "Dogs" : 386
    "Cats" : 85
    "Rats" : 15
</pre>
        </panel>
        <div>
          <pre class="mermaid">
graph TD;
    A-->B;
    A-->C;
    B-->D;
    C-->D;
</pre>
        </div>
        <panel type="minimal" src="/test_site/testMermaidInclude._include_.html"><template #header>
            <p>This is to test Mermaid diagrams works when included inside a panel.</p>
          </template></panel>
      </div>
      <overlay-source id="page-nav" tag-name="nav" to="page-nav">
        <div class="nav-component slim-scroll">
        </div>
      </overlay-source>
      <scroll-top-button></scroll-top-button>
    </div>
    <div>
      <footer>
        <h1 id="heading-in-footer-should-not-be-indexed">Heading in footer should not be indexed<a class="fa fa-anchor" href="#heading-in-footer-should-not-be-indexed" onclick="event.stopPropagation()"></a></h1>
        <div class="text-center">
          This is a dynamic height footer that supports markdown <span>üòÑ</span>!
        </div>
      </footer>
    </div>
  </div>
</body>
<script src="/test_site/markbind/js/bootstrap-utility.min.js"></script>
<script src="/test_site/markbind/js/polyfill.min.js"></script>
<script src="/test_site/markbind/js/vue.global.prod.min.js"></script>
<script src="/test_site/markbind/js/markbind.min.js"></script>
<script src="testMermaid.page-vue-render.js"></script>
<script>
  MarkBind.setupWithSearch()
</script>
<script src="/test_site/plugins/testMarkbindPlugin/testMarkbindPluginScript.js"></script>
<script>alert("Inline plugin script loaded!")</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=TRACKING-ID"></script>
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'TRACKING-ID');
    </script>

<script>
        function submitForm(element) {
            event.preventDefault();
            const formData = new FormData(element);
            const formProps = Object.fromEntries(formData);
            const json = JSON.stringify(formProps);
            const submitButton = element.querySelector('button[type="submit"]');
            const submitButtonText = submitButton.innerText;
            submitButton.innerText = 'Please wait...'
            fetch('https://api.web3forms.com/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: json,
            })
            .then(async (response) => {
                if (response.status == 200) {
                    alert('Form submitted! Thank you for your response');
                } else {
                    alert('Error submitting form! Please try again later.');
                }
            })
            .catch(error => {
                alert('Error submitting form! Please try again later.');
            })
            .finally(() => {
                submitButton.innerText = submitButtonText;
            })
        }
    </script>
<script type="module">
    window.mermaidPromise = null;
    
    const loadMermaid = () => {
      if (window.mermaidPromise === null) {
        window.mermaidPromise = import('https://unpkg.com/mermaid@10/dist/mermaid.esm.min.mjs')
          .then(({ default: mermaid }) => {
            mermaid.initialize({
              startOnLoad: false,
            });
            console.log('Mermaid loaded successfully');
            return mermaid;
          })
          .catch((error) => {
            console.error('Mermaid failed to load:', error);
            window.mermaidPromise = false;
            return null;
          });
      }
      return window.mermaidPromise;
    };

    const renderMermaidDiagrams = (elements) => {
      if (!elements || elements.length === 0) {
        return Promise.resolve();
      }

      return loadMermaid().then(mermaid => {
        if (!mermaid) return;
        return mermaid.run({ nodes: Array.from(elements) })
          .catch(err => console.error('Error rendering mermaid diagrams:', err));
      });
    };

    const setupMermaidObserver = () => {
      const observer = new MutationObserver((mutations) => {
        let newMermaidElements = [];
        
        mutations.forEach(mutation => {
          if (mutation.addedNodes.length) {
            mutation.addedNodes.forEach(node => {
              if (node.nodeType === 1 && node.classList && 
                  node.classList.contains('mermaid')) {
                newMermaidElements.push(node);
              }
              
              if (node.nodeType === 1 && node.querySelectorAll) {
                const mermaidInNode = node.querySelectorAll('.mermaid');
                if (mermaidInNode.length) {
                  newMermaidElements = [...newMermaidElements, ...mermaidInNode];
                }
              }
            });
          }
        });
        
        if (newMermaidElements.length > 0) {
          renderMermaidDiagrams(newMermaidElements);
        }
      });
      
      observer.observe(document.body, {
        childList: true,
        subtree: true
      });
      
      return observer;
    };

    // Initialize on DOM content loaded
    document.addEventListener('DOMContentLoaded', () => {
      const existingDiagrams = document.querySelectorAll('.mermaid');
      if (existingDiagrams.length > 0) {
        renderMermaidDiagrams(existingDiagrams);
      }
      
      setupMermaidObserver();
    });

  </script>

</html>